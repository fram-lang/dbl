import /List
import open /String
import open Testing

let _ = testSuite "substring" (fn _ =>
  
  testCase "takes whole string" (fn _ =>
    assertEqS (substring "abcdef" 0 6) "abcdef");
    
  testCase "returns empty string for empty range" (fn _ =>
    assertEqS (substring "abcdef" 0 0) "";
    assertEqS (substring "abcdef" 6 0) "";
    assertEqS (substring "" 0 0) "");
  
  testCase "returns substring on non empty range" (fn _ =>
    assertEqS (substring "abcdef" 1 3) "bcd"))

let _ = testSuite "findChar" (fn _ =>
  
  testCase "does not find char" (fn _ =>
    assertEq (findChar "abcdef" ':') None;
    assertEq (findChar "" ':') None);
  
  testCase "finds index from beginning" (fn _ =>
    assertEq (findChar "abc:def" ':') (Some 3);
    assertEq (findChar "ab:cd:ef" ':') (Some 2));
  
  testCase "finds all indexes iteratively" (fn _ =>
    let str = "do:re:mi:fa" in
    expectEq (findChar {begin=0} str ':') (Some 2);
    expectEq (findChar {begin=3} str ':') (Some 5);
    expectEq (findChar {begin=6} str ':') (Some 8);
    expectEq (findChar {begin=9} str ':') None))

let _ = testSuite "splitOn" (fn _ =>
  
  testCase "returns unsplitted string" (fn _ =>
    expectEq (splitOn "abcdef" ':') ["abcdef"];
    expectEq (splitOn "" ':') [""]);
  
  testCase "singular split" (fn _ =>
    expectEq (splitOn "abc:def" ':') ["abc", "def"];
    expectEq (splitOn "abc:" ':') ["abc", ""];
    expectEq (splitOn ":abc" ':') ["", "abc"];
    expectEq (splitOn ":" ':') ["", ""]);
  
  testCase "multiple splits" (fn _ =>
    expectEq (splitOn "do:re:mi" ':') ["do", "re", "mi"];
    expectEq (splitOn ":::" ':') ["", "", "", ""]))
