import open Mutable
import open /Vector
import open /String
import open Testing

let _ = testSuite "vector" (fn _ =>

  testCase "size and capacity methods" (fn _ =>
    let vec = makeVector {T=Int} 4 in
    let sz = vec.size in
    let cap = vec.capacity in
    assertEqS sz 4;
    assertEqS cap 4);

  testCase "front and back methods" (fn _ =>
    let vec = makeVector {T=Int} 4 in
    vec.set 0 1;
    vec.set 1 2;
    vec.set 2 3;
    vec.set 3 4;
    vec.pushBack 5;
    let fst = vec.front in
    let lst = vec.back in
    assertEqS fst 1;
    assertEqS lst 5);
  
  testCase "get method" (fn _ =>
    let vec = makeVector {T=Int} 0 in
    vec.pushBack 6;
    vec.pushBack 7;
    vec.pushBack 8;
    vec.pushBack 9;
    let x = vec.get 1 in
    let y = vec.get 3 in
    assertEqS x 7;
    assertEqS y 9);
    
  testCase "clear method" (fn _ =>
    let vec = makeVector {T=Int} 4 in
    vec.clear;
    let sz = vec.size in
    let cap = vec.capacity in
    assertEqS sz 0;
    assertEqS cap 0);

  testCase "from/to list methods" (fn _ =>
    let xs = [1,2,3,4] in
    let vec = fromList xs in
    let x = vec.get 0 in
    let y = vec.get 2 in
    let ys = vec.toList in
    let z = ys.hd in
    assertEqS x 1;
    assertEqS y 3;
    assertEqS z (Some 1));

    testCase "vector of strings" (fn _ =>
    let vec = makeVector {T=String} 2 in
    vec.set 0 "abc";
    vec.set 1 "ab";
    vec.pushBack "a";
    let fst = vec.front in
    let lst = vec.back in
    assertEqS fst "abc";
    assertEqS lst "a"))
    